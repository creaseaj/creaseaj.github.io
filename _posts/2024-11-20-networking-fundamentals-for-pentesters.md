---
title: "Networking Fundamentals for Pentesters"
date: 2024-11-20
tags: [networking, fundamentals, pentesting, osi, routing, protocols]
categories: [networking_fundamentals]
---

> A solid grasp of networking is one of the most valuable skills for a penetration tester. If you don't understand how data moves, you won't understand how to break or secure it.

## Why Networking Knowledge Matters in Pentesting

Almost every security test, from a simple vulnerability scan to a full red-team engagement, depends on network communication. Knowing how protocols work, how hosts discover each other, and how routing decisions are made helps you:
- Identify attack surfaces
- Spot misconfigurations
- Choose the right tools and techniques

---

## The OSI Model (Practical View for Pentesters)

While the **OSI model** is often taught as theory, it’s a useful mental map for troubleshooting and exploiting network behavior:

1. **Layer 1 — Physical**: Cables, Wi-Fi signals, physical access points.  
   - Pentester note: Poor physical security = possible network jack access.
2. **Layer 2 — Data Link**: Ethernet frames, MAC addresses, VLANs.  
   - Attacks: ARP spoofing, VLAN hopping.
3. **Layer 3 — Network**: IP addressing, routing.  
   - Attacks: IP spoofing, subnet misconfig.
4. **Layer 4 — Transport**: TCP/UDP ports, sessions.  
   - Attacks: Port scanning, DoS, fuzzing.
5. **Layer 5–7 — Session / Presentation / Application**: Encryption, HTTP, DNS, etc.  
   - Attacks: Application layer exploits, downgrade attacks.

---

## Key Protocols and Their Relevance

| Protocol      | Purpose                | Pentest Relevance                |
| ------------- | ---------------------- | -------------------------------- |
| **ARP**       | Resolves IP to MAC     | ARP spoofing, MITM               |
| **ICMP**      | Network diagnostics    | Host discovery, ICMP tunneling   |
| **DNS**       | Name resolution        | Zone transfers, DNS exfiltration |
| **HTTP/S**    | Web comms              | Web app pentesting               |
| **SMTP/IMAP** | Email                  | Phishing, mailbox enumeration    |
| **SMB**       | File sharing (Windows) | Lateral movement, Null sessions  |
| **SSH**       | Remote shell           | Brute force, weak key configs    |

---

## Discovery and Enumeration

Before attacking, you need to **map the network**.

Example commands:
```bash
# Nmap fast scan
nmap -T4 -F 192.168.1.0/24

# Service detection
nmap -sV 192.168.1.0/24
```

Pentester Tips

- **Run version detection on UDP scans** — UDP scans alone (`-sU`) can’t always tell if a port is open or closed; adding version detection (`-sV`) helps confirm service state and identify what’s running.  
- **Use `-T4` when speed is needed** — it’s fast without breaking too many timing-sensitive checks.  
- **Avoid `-T5` unless absolutely necessary** — it’s so aggressive it can cause Nmap scripts to time out, leading to lost results.  
- **Target UDP and TCP separately** — reduces noise and can improve accuracy for tricky services.  
- **Re-scan interesting hosts** — after initial discovery, run targeted, detailed scans on high-value IPs.  
---

## Routing Concepts

Understanding routing is essential when testing segmented networks:
- **Static routes**: Manually set; easier to overlook in configs.
- **Dynamic routing protocols**: OSPF, BGP, RIP, often trusted without authentication in internal networks.
- **Pivoting**: Once inside a compromised host, you may need to route traffic through it to reach otherwise inaccessible networks.

---

## Layer 2 Attacks in Pentests

These often work when network segmentation is poorly enforced:
- **ARP Spoofing**: Poison ARP caches to intercept traffic.
- **MAC Flooding**: Overload switches to force fail-open to hub mode.
- **VLAN Hopping**: Exploit misconfigured trunk ports.

---

## Common Pitfalls

- Ignoring IPv6 - many orgs leave it enabled and unsecured.
- Over-reliance on noisy active scans.
- Assuming DNS is correct - poisoned or misconfigured records can hide targets.

---

## Conclusion

Networking knowledge turns a pentest from "scan-and-report" into a real security assessment. The more you understand how the target’s network *really* works, the more attack paths you’ll find, and the more value you deliver.

